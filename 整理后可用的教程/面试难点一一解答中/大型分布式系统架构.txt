大型分布式系统架构

分布式最基础的两个协议，一个是paxos选举协议，一个是两阶段提交协议。
paxos选举协议：用于在多个节点中选举一个总控节点
两阶段提交协议：保证在多个节点中事务操作的原子性，要么完全成功，要么全部失败。

分布式系统中的一致性
分布式中为了处理容错，发生故障的数据恢复问题，一般容错采用的是多副本策略，即当一个节点出现故障的时候，可以从其他的副本读取数据，保证副本的有效性。

分布式中如何保证多个副本的一致性
一致性主要分为以下三个等级：
1、强一致性：某个节点写了数据，其他节点读取操作都一定会返回最新的数据值
2、弱一致性：某个节点写了数据，不能保证其他后续的节点读取操作可以返回最新的值
3、最终一致性：某个节点写了数据，在之后的某一段时间内，其他节点读取操作都一定会返回最新的数据值，超过这段时间可能不会。

分布式系统中的数据分布
由于数据是分布在不同节点上，那么数据分布是分布式必须要考虑的一点，数据部分主要有两种：
1、哈希分布，例如一致性哈希分布
2、顺序分布：将一个整体顺序的大表，按照顺序划分为各个子表，然后把各个子表分到不同的节点上。


分布式系统中负载均衡
分为强同步和异步复制：
强同步
整个流程如下：
1、客户端将写的请求发送给主副本，
2、主副本首先将操作日志同步到各备副本，同步成功后发给主副本
3、主副本成功后发回给客户端。
异步复制：
1、客户端将写的请求发送给主副本，
2、主副本写完即返回给客户端，不关系背副本是否同步成功

分布式系统中的容错机制
常见检测故障的方法
1、心跳包，不同的发送心跳包，有回复则是好的，没有回复就是坏的。
2、租约机制，机器A检测B是否发生故障，没有发生故障就给予租期，在租期内可以进行服务，租期到了再次检测并申请租期，申请成功后才能再次服务。如果某个机器发生了故障，那么就不能申请租期，一旦租期到了就不会提供服务，将原本的服务转由其他的服务完成。

